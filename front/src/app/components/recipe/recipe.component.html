<div class="container">
    <app-header></app-header>
    <div class="recipe-header">
        <div class="info-header row" style="text-align: center;">
            <div class="col info">Total time<br>
                <div class="stats">{{recipe.prepTime + recipe.cookTime}}<span>mins</span></div>
            </div>
            <div class="col recipe">
                <h1>{{recipe.title}}</h1><br>
                <h2 [routerLink]="['/profile', recipe.owner?._id]" style="cursor: pointer;">{{recipe.owner?.firstName}} {{recipe.owner?.lastName}}</h2><br>
                <img [src]="url.concat('/', recipe.image)"><br>
                <span class="info">{{recipe.servingSize}} servings</span>
            </div>
            <div class="col info">
                Recipe rating<i class="fa fa-trash" *ngIf="owned" (click)="deleteRecipe(recipe._id);"></i><i *ngIf="token && !owned && saved" (click)="unsaveRecipe(recipe._id);" class="fa fa-bookmark"></i><i *ngIf="token && !owned && !saved" (click)="saveRecipe(recipe._id);" class="fa fa-bookmark-o"></i><br>
                <div class="stats">{{recipe.averageRating}}<i class="fa fa-star"></i></div><br>
                <button class="rate-recipe" *ngIf="token && !owned && !rated"  data-bs-toggle="modal" data-bs-target="#myModal">Rate this recipe</button>
            </div>
        </div>
    </div>
    <div class="description">
        <h1>Description</h1>
        <p>{{recipe.description}}</p>
    </div>
    <div class="sec ingredients">
        <h1>Ingredients</h1>
        <div class="ingredients-list">
            <ul>
                <li *ngFor="let ingredient of recipe.ingredients">{{ingredient}}</li>
            </ul>
        </div>
    </div>

    <div class="sec instructions">
        <h1>Instructions</h1>
        <div class="instructions-list">
            <ol>
                <li *ngFor="let step of recipe.steps">{{step}}</li>
            </ol>
        </div>
    </div>

    <div *ngIf="token" class="sec leave-comment">
        <h1>Leave a comment</h1>
        <div class="new-comment">
           <textarea class="form-control" [(ngModel)]="text" placeholder="Write your comment here..."></textarea>
           <i class="fa fa-send" (click)="comment()"></i>
        </div>
    </div>

    <div class="sec comments">
        <h1>Comments ({{pagination.totalItems}})</h1>
        <div class="comment-section">
            <div class="comment row" *ngFor="let comment of recipe.comments">
                <div class="col-1">
                    <img [src]="url.concat('/', comment.user.image)" [alt]="url.concat(comment.user.image)">
                </div>
                <div class="col">
                    <h1>{{comment.user.firstName}} {{comment.user.lastName}}</h1><br>
                    <p>{{comment.text}}</p>
                </div>
            </div>
            <span *ngIf="pagination.totalPages > 1">
                <span class="pagination-numbers">
                    <span *ngFor="let page of totalPagesArray(pagination)" class="page-number" [class.active]="page == pagination.currentPage" (click)="gotoPage(page)">
                      {{ page }}
                    </span>
                  </span>
            </span>
        </div>
    </div>
    <app-recipe-form [recipe]="recipe"></app-recipe-form>
    <div class="modal fade" id="myModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Modal Title</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
      
            <div class="modal-body">
                <label>Rating:</label>
                <input type="number" min="1" max="5" [(ngModel)]="rating" required>
                <button (click)="rate()">Rate</button>
            </div>
      
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
</div>
<script>

</script>